---
title: Экспорт данных из визуализации Power BI
description: Экспортируйте данные из визуализаций отчетов и панелей мониторинга и просматривайте их в Excel.
author: mihart
manager: kvivek
ms.reviewer: ''
featuredvideoid: jtlLGRKBvXY
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 10/30/2019
ms.author: mihart
LocalizationGroup: Visualizations
ms.openlocfilehash: be85769d8ae2340843a4ebdeb5c88ffc2ca86920
ms.sourcegitcommit: 8cc2b7510aae76c0334df6f495752e143a5851c4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/01/2019
ms.locfileid: "73431091"
---
# <a name="export-data-from-visualizations"></a>Экспорт данных из визуализаций

Чтобы просмотреть данные, которые Power BI использует для создания визуализации, [откройте их в Power BI](service-reports-show-data.md). Вы также можете экспортировать данные в Excel в виде файла *XLSX* или *CSV*. Для экспорта данных требуется лицензия Pro или Premium и права на редактирование набора данных и отчета.

Просмотрите видео, в котором показан экспорт данных из визуализации в отчете и сохранение их в файл *XLSX* с последующим просмотром в Excel. Затем сделайте то же самое, выполнив пошаговые инструкции, приведенные под видео.

<iframe width="560" height="315" src="https://www.youtube.com/embed/KjheMTGjDXw" frameborder="0" allowfullscreen></iframe>

## <a name="export-data-from-a-power-bi-dashboard"></a>Экспорт данных из панели мониторинга Power BI

1. Щелкните многоточие в правом верхнем углу визуализации.

    ![Снимок экрана: визуализация со стрелкой, указывающей на кнопку с многоточием.](media/power-bi-visualization-export-data/pbi-export-tile3.png)

1. Выберите значок **Экспорт данных**.

    ![Снимок экрана: раскрывающийся список кнопки с многоточием с выделенным параметром экспорта данных.](media/power-bi-visualization-export-data/pbi_export_dash.png)

1. Power BI экспортирует данные в файл *CSV*. Если выполнить фильтрацию визуализации, приложение отфильтрует скачанные данные.

1. Браузер предложит сохранить файл.  Откройте сохраненный файл *CSV* в Excel.

    ![Снимок экрана: файл CSV, отображающий экспортированные данные.](media/power-bi-visualization-export-data/pbi-export-to-excel.png)

## <a name="export-data-from-a-report"></a>Экспорт данных из отчета

Для начала откройте [отчет по примеру анализа закупок](../sample-procurement.md) в представлении редактирования. Добавьте новую пустую страницу отчета. Затем выполните следующие действия, чтобы добавить агрегирование и фильтры уровня визуализации.

1. Создайте **гистограмму с накоплением**.

1. В области **Поля** выберите **Location > City** (Расположение > Город) и **Invoice > Discount Percent** (Счет > Процент скидки).  Возможно, нужно будет переместить **Discount Percent** (Процент скидки) в область **Значение**.

    ![Снимок экрана: создаваемая визуализация с выделенными параметрами City (Город) и Count of Discount Percent (Число процента скидки).](media/power-bi-visualization-export-data/power-bi-export-data3.png)

1. Измените тип агрегации для **процента скидки** с **количества** на **среднее значение**. В области **Значение** щелкните стрелку справа от параметра **Discount Percent** (Процент скидки) (он может называться **Count of Discount Percent** (Число процента скидки)) и выберите значение **Average** (Среднее значение).

    ![Снимок экрана: список вариантов агрегирования с выделенным параметром "Среднее значение".](media/power-bi-visualization-export-data/power-bi-export-data6.png)

1. Добавьте фильтр к параметру **City** (Город), выберите все города, а затем удалите город **Атланта**.

    ![Снимок экрана: фильтр параметра City (Город) с убранным флажком напротив "Атланта, штат Джорджия".](media/power-bi-visualization-export-data/power-bi-export-data4.png)

   Теперь можно попробовать оба варианта для экспорта данных.

1. Щелкните многоточие в правом верхнем углу визуализации. Выберите пункт **Экспорт данных**.

    ![Снимок экрана: кнопка с многоточием в правом верхнем углу и выделенный параметр "Экспорт данных".](media/power-bi-visualization-export-data/power-bi-export-data2.png)

    В веб-клиенте Power BI, если в визуализации есть статистическое выражение (например, если значение **количества** заменено на *среднее значение*, *сумму* или *минимальное значение*), вам доступно два варианта:

    - **Сводные данные**;

    - **Базовые данные**.

    В Power BI Desktop вам доступен только вариант **Сводные данные**. Дополнительные сведения о статистических выражениях см. в статье [Статистические выражения в Power BI](../service-aggregates.md).

1. В области **Экспорт данных** установите переключатель **Сводные данные** или выберите *XLSX* или *CSV*, а затем нажмите кнопку **Экспорт**. Power BI экспортирует данные.

    ![Снимок экрана: снимок экрана экспорта данных с выделенными параметрами "Сводные данные", "XLSX" и "Экспорт".](media/power-bi-visualization-export-data/power-bi-export-data5.png)

    Если к визуализации применялись фильтры, экспортированные данные будут экспортированы с учетом фильтров. При выборе элемента **Экспорт** браузер предложит сохранить файл. Откройте сохраненный файл в программе Excel.
    
    Экспортируются все данные, используемые иерархией, а не только данные, используемые для текущего уровня детализации визуального элемента. Например, если визуализация еще не была детализирована с верхнего уровня, экспортируемые данные будут содержать все данные в иерархии, а не только данные, используемые для создания визуального элемента на текущем уровне детализации.

    **Сводные данные**: выберите этот вариант, если вы хотите экспортировать данные, которые отображаются в этом визуальном элементе.  Этот тип экспорта отображает только данные (столбцы и меры), которые вы выбрали для создания визуального элемента.  Если визуальный элемент содержит статистическое выражение, будут экспортированы объединенные данные. Например, если в гистограмме отображается четыре столбца, вы получите четыре строки данных. Сводные данные можно получить в формате *XLSX* и *CSV*.

    В этом примере в экспортированных данных Excel отображается итоговая сумма для каждого города. Так как мы исключили Атланту, этого города нет в результатах. В первой строке электронной таблицы отображаются фильтры, которые служба Power BI использовала при извлечении данных.

    ![Снимок экрана: файл CSV, отображающий экспортированные данные.](media/power-bi-visualization-export-data/power-bi-export-data7.png)

1. Теперь выберите **Базовые данные**, файл *XLSX*, а затем — **Экспорт**. Power BI экспортирует данные. 

    > [!NOTE]
    > В зависимости от параметров отчета может быть доступен параметр экспорта базовых данных.

    Если к визуализации применялись фильтры, экспортированные данные будут экспортированы с учетом фильтров. При выборе элемента **Экспорт** браузер предложит сохранить файл. Откройте сохраненный файл в программе Excel.
    
    Экспортируются все данные, используемые иерархией, а не только данные, используемые для текущего уровня детализации визуального элемента. Например, если визуализация еще не была детализирована с верхнего уровня, экспортируемые данные будут содержать все данные в иерархии, а не только данные, используемые для создания визуального элемента на текущем уровне детализации.

    >[!WARNING]
    >Экспорт базовых данных позволяет пользователям видеть все подробные сведения, включая каждый столбец в данных. Администраторы службы Power BI могут отключить этот параметр для своей организации. Если вы являетесь владельцем набора данных, определите собственные столбцы как **скрытые**, чтобы они не отображались в списке **Поля** на рабочем столе или в службе Power BI.

    **Базовые данные**: выберите этот вариант, если вы хотите просмотреть данные в визуальном элементе ***и*** дополнительные данные из модели (дополнительные сведения см. в диаграмме ниже). Если визуализация содержит статистическое выражение, при выборе варианта *Базовые данные* статистическое выражение удаляется. Когда вы нажмете кнопку **Экспорт**, Power BI экспортирует данные в файл *XLSX* и браузер предложит сохранить этот файл. Откройте сохраненный файл в программе Excel.

    В этом примере в экспортированных данных Excel отображается по одной строке для каждой строки "Город" в наборе данных и процент скидки для одной записи. Power BI преобразовывает данные в плоскую структуру. Агрегирование данных не выполняется. В первой строке электронной таблицы отображаются фильтры, которые служба Power BI использовала при извлечении данных.  

    ![Снимок экрана: файл CSV, отображающий экспортированные данные.](media/power-bi-visualization-export-data/power-bi-export-data8.png)

## <a name="export-underlying-data-details"></a>Сведения об экспорте базовых данных

Данные, отображаемые при выборе варианта **Базовые данные**, могут различаться. Для понимания этих сведений может потребоваться помощь администратора или ИТ-отдела. В Power BI Desktop или в службе Power BI в представлении отчетов *мера* отображается в списке **Поля** со значком калькулятора ![отображение значка](media/power-bi-visualization-export-data/power-bi-calculator-icon.png). Power BI Desktop создает меры, а служба Power BI — нет.

| Визуальный элемент содержит | Что вы видите при экспорте  |
|---------------- | ---------------------------|
| Статистические выражения | *Первое* статистическое выражение и нескрытые данные из всей таблицы для этого статистического выражения |
| Статистические выражения | Связанные данные — если визуальный элемент использует данные из других таблиц данных, которые *связаны* с таблицей данных, содержащей статистическое выражение (если это связь типа \*: 1 или 1:1) |
| Меры | Все меры в визуальном элементе *и* все меры из любой таблицы данных, содержащей меру, используемую в визуальном элементе |
| Меры | Все нескрытые данные из таблиц, содержащих эту меру (если это связь типа \*: 1 или 1:1) |
| Меры | Все данные из всех таблиц, связанных с таблицей, содержащей меры с помощью цепочки \*: 1 из 1:1 |
| Только меры | Все нескрытые столбцы из всех связанных таблиц (для расширения меры) |
| Только меры | Сводные данные для всех повторяющихся строк для мер модели |

### <a name="set-the-export-options"></a>Настройка параметров экспорта

Конструкторы отчетов Power BI управляют типами параметров экспорта данных, которые доступны для пользователей. Доступные варианты:

- Разрешить пользователям экспортировать сводные данные из службы Power BI или Сервера отчетов Power BI

- Разрешить пользователям экспортировать сводные и базовые данные из службы или Сервера отчетов

- Запретить пользователям экспортировать данные из службы или Сервера отчетов

    > [!IMPORTANT]
    > Мы рекомендуем конструкторам отчетов вернуться к старым отчетам и вручную сбросить параметр экспорта при необходимости.

Чтобы настроить эти параметры, сделайте следующее:

1. Запустите Power BI Desktop.

1. В левом верхнем углу выберите **Файл** > **Параметры и настройки** > **Параметры**.

1. В разделе **ТЕКУЩИЙ ФАЙЛ** выберите **Параметры отчета**.

    ![Параметры отчетов](media/power-bi-visualization-export-data/desktop-report-settings.png)

1. Выберите нужный вариант в разделе **Экспорт данных**.

Этот параметр также можно обновить в службе Power BI.

Учтите, что конфликтующие параметры портала администрирования Power BI переопределяют параметры отчета для экспорта данных.

## <a name="limitations-and-considerations"></a>Рекомендации и ограничения
Эти ограничения и рекомендации применяются к Power BI Desktop и службе Power BI, включая Power BI Pro и Premium.

- Чтобы экспортировать данные из визуального элемента, вам нужно иметь [разрешение на сборку для базового набора данных](https://docs.microsoft.com/power-bi/service-datasets-build-permissions#build-permissions-for-shared-datasets).

-  Максимальное число строк, которые **Power BI Desktop** и **служба Power BI** могут экспортировать из **отчета режима импорта** в файл *CSV*, составляет 30 000.

- Максимальное число строк, которые приложения могут экспортировать из **отчета режима импорта** в файл *XLSX*, составляет 150 000.

- Экспорт с использованием *базовых данных* не будет выполняться, если:

  - источник данных — это активное подключение к службам Analysis Services;

  - версия старше 2016;

  - для таблиц в модели не существует уникального ключа;
    
  -  администратор или конструктор отчетов отключил эту функцию.

- Экспорт с использованием *базовых данных* не будет работать, если вы включите параметр *Показать элементы без данных*.для визуализации, которую экспортирует Power BI.

- При использовании DirectQuery максимальный объем данных, который Power BI может экспортировать, составляет 16 МБ несжатых данных. Непреднамеренным результатом может быть то, что вы экспортируете меньше, чем максимальное количество строк. Это вероятно, если:

    - существует много столбцов;

    - существуют данные, которые сложно сжать;

    - существуют другие факторы, из-за которых увеличивается размер файла и уменьшается количество строк, которые Power BI может экспортировать.

- Если визуализация использует данные из нескольких таблиц данных и для этих таблиц в модели данных не существует связей, Power BI экспортирует только данные для первой таблицы.

- Пользовательские визуальные элементы и визуальные элементы R пока не поддерживаются.

- В Power BI вы можете переименовать поле (столбец), дважды щелкнув его и введя новое имя. Power BI рассматривает новое имя как *псевдоним*. В отчете Power BI в итоге могут оказаться повторяющиеся имена полей, однако в Excel они запрещены. Поэтому когда Power BI экспортирует данные в Excel, псевдонимы заменяются исходными именами полей (столбцов).  

- Если в файле *CSV* содержатся знаки Юникода, то текст в Excel может отображаться неправильно. Примерами знаков Юникода являются символы валют и иностранные слова. Вы можете открыть файл в Блокноте, чтобы знаки Юникода отобразились правильно. Если вы хотите открыть файл в Excel, необходимо импортировать файл *CSV*. Чтобы импортировать файл в Excel, сделайте следующее:

  1. Откройте Excel.

  1. Перейдите на вкладку **Данные**.
  
  1. Выберите **Получение внешних данных** > **Из текста**.
  
  1. Перейдите к локальной папке, где хранится файл, и выберите файл *CSV*.

- Администраторы Power BI могут отключить экспорт данных.

Появились дополнительные вопросы? [Попробуйте задать вопрос в сообществе Power BI.](http://community.powerbi.com/)
